var de=Object.defineProperty,ce=Object.defineProperties;var ue=Object.getOwnPropertyDescriptors;var oe=Object.getOwnPropertySymbols;var pe=Object.prototype.hasOwnProperty,me=Object.prototype.propertyIsEnumerable;var se=(o,e,r)=>e in o?de(o,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):o[e]=r,R=(o,e)=>{for(var r in e||(e={}))pe.call(e,r)&&se(o,r,e[r]);if(oe)for(var r of oe(e))me.call(e,r)&&se(o,r,e[r]);return o},re=(o,e)=>ce(o,ue(e));import{j as V,r as s,d as S,t as he,F as P,f as ge,b as fe,o as ye,p as be,c as xe,m as ve,a as J,M as we,e as Se,g as Ce,S as ke,L as Ne,N as Fe,G as Ie,h as Ae,i as Ee,k as Le,R as Oe,l as je}from"./vendor.7ffff765.js";const _e=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))i(a);new MutationObserver(a=>{for(const c of a)if(c.type==="childList")for(const f of c.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&i(f)}).observe(document,{childList:!0,subtree:!0});function r(a){const c={};return a.integrity&&(c.integrity=a.integrity),a.referrerpolicy&&(c.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?c.credentials="include":a.crossorigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function i(a){if(a.ep)return;a.ep=!0;const c=r(a);fetch(a.href,c)}};_e();const t=V.exports.jsx,l=V.exports.jsxs,C=V.exports.Fragment,ne=()=>{const[o,e]=s.exports.useState(!1);s.exports.useEffect(()=>{e(S.exports.isLoggedIn())},[]);const r=s.exports.useCallback(()=>{(async()=>(await S.exports.login({mode:"popup",clientId:"q9sRK4UuNqv3_HLE8E7m2-wUAKS3XJSFWb9apehpAqE",scopes:["read_prefs","write_api","write_notes"],redirectUrl:window.location.href.replace(window.location.hash,"")}),e(S.exports.isLoggedIn()),window.location.reload()))()},[]),i=s.exports.useCallback(()=>{(async()=>(S.exports.logout(),e(!1)))()},[]);return t(C,{children:o?t("button",{style:{height:"44px"},className:"button py-1 px-1 border-transparent border-4 bg-gray-300 text-gray-900 hover:text-gray-500",onClick:i,children:"logout"}):t("button",{style:{height:"44px"},className:"button py-1 px-1 border-transparent border-4 bg-gray-300 text-gray-900 hover:text-gray-500",onClick:r,children:"login"})})},Me=()=>{const[o,e]=s.exports.useState(!1),[r,i]=s.exports.useState(void 0);return s.exports.useEffect(()=>{e(S.exports.isLoggedIn())},[]),s.exports.useEffect(()=>{!o||(async()=>{const a=await S.exports.getUser("me");i(a)})()},[o]),t(C,{children:r?t("img",{style:{width:"44px",height:"44px"},src:r.img.href,alt:r.display_name,title:r.display_name}):t("img",{})})},Re=()=>{const[o,e]=s.exports.useState(!1),[r,i]=s.exports.useState(void 0);return s.exports.useEffect(()=>{e(S.exports.isLoggedIn())},[]),s.exports.useEffect(()=>{!o||(async()=>{const a=await S.exports.getUser("me");i(a)})()},[o]),l("div",{style:{zIndex:100,position:"relative",top:0,left:0,height:"44px",display:"flex",flexDirection:"row",backgroundColor:"rgba(0, 255, 255, 0.9)"},children:[l("div",{children:[t("h1",{className:"text-4xl font-bold",style:{display:"inline",margin:"0px"},children:"OSM address editor"}),r?l("span",{style:{marginLeft:"10px"},children:["Hi ",r==null?void 0:r.display_name,", You have"," ",r==null?void 0:r.changesets.count," changesets."]}):t("span",{style:{marginLeft:"10px"},children:"Please log in with your OSM account."})]}),l("div",{style:{display:"flex",flex:1,justifyContent:"end"},children:[t("div",{children:t(Me,{})}),t("div",{children:t(ne,{})})]})]})},le=({feature:o})=>{var r;const e=JSON.parse((r=o.properties)==null?void 0:r.center);return l(C,{children:[l("span",{className:"longitude",children:["Longitude: ",Math.round(e[0]*1e4)/1e4]}),", ",l("span",{className:"latitude",children:["Latitude: ",Math.round(e[1]*1e4)/1e4," "]})]})},Pe=({feature:o})=>t(C,{children:o.properties&&Object.keys(o.properties).map(e=>{var r;if(e.startsWith("addr"))return l("div",{className:e,children:[t("span",{className:"underline",children:e})," = ",t("span",{children:(r=o.properties)==null?void 0:r[e]})]})})}),Ue=({feature:o,size:e})=>o.properties===null?null:t(C,{children:o.properties.userIconHref.length>0?t("img",{src:o.properties.userIconHref,style:{width:e+"px",height:e+"px"}}):t("span",{dangerouslySetInnerHTML:{__html:he(o.properties.user||"noname",e)}})}),ze=({feature:o})=>{var e;return((e=o.properties)==null?void 0:e.uid)?l("span",{children:["Last edited by: ",o.properties.user]}):null},Te=({viewState:o})=>{const[e,r]=s.exports.useState(`https://twitter.com/intent/tweet?url=${encodeURIComponent(window.location.href)}`);return s.exports.useEffect(()=>{r(`https://twitter.com/intent/tweet?url=${encodeURIComponent(window.location.href)}`)},[o]),t(C,{children:o&&e&&l("a",{href:e,target:"_blank",className:"twitter-share-button",style:{backgroundColor:"#1d9bf0",color:"white",padding:"3.5px 8px",borderRadius:"15px"},children:[t(P,{icon:ge,style:{padding:"0px 3px"}}),t("span",{style:{padding:"0px 3px"},children:"Tweet"})]})})},qe={defaultComment:"\u66F4\u65B0\u5730\u5740",postcodeField:{key:"addr:postcode",displayName:"Postcode",placeholder:""},mainFields:[{key:"addr:province",displayName:"Province/Municipality/AR/SAR",placeholder:""},{key:"addr:city",displayName:"City/Prefecture/League",placeholder:""},{key:"addr:district",displayName:"District/County/Banner",placeholder:""}],detailFields:[{key:"addr:street",displayName:"Street",placeholder:""},{key:"addr:housenumber",displayName:"House number",placeholder:""}]},De={defaultComment:"Aktualisierte Adresse",postcodeField:{key:"addr:postcode",displayName:"Postcode",placeholder:""},mainFields:[{key:"addr:city",displayName:"City",placeholder:""},{key:"addr:suburb",displayName:"District/Suburb",placeholder:""}],detailFields:[{key:"addr:street",displayName:"Street",placeholder:""},{key:"addr:housenumber",displayName:"House number",placeholder:""}]},Be={defaultComment:"\u4F4F\u6240\u3092\u66F4\u65B0",postcodeField:{key:"addr:postcode",displayName:"\u90F5\u4FBF\u756A\u53F7",placeholder:"101-0021"},mainFields:[{key:"addr:province",displayName:"\u90FD\u9053\u5E9C\u770C",placeholder:"\u6771\u4EAC\u90FD",adminLevel:4},{key:"addr:city",displayName:"\u5E02\u753A\u6751\u3068\u6771\u4EAC23\u533A",placeholder:"\u5343\u4EE3\u7530\u533A",adminLevel:7},{key:"addr:suburb",displayName:"\u653F\u4EE4\u6307\u5B9A\u90FD\u5E02\u306E\u533A",placeholder:""},{key:"addr:quarter",displayName:"\u5730\u540D",placeholder:"\u5916\u795E\u7530",adminLevel:9}],detailFields:[{key:"addr:neighbourhood",displayName:"\u4E01\u76EE",placeholder:"1\u4E01\u76EE"},{key:"addr:block_number",displayName:"\u756A\u5730",placeholder:"17"},{key:"addr:housenumber",displayName:"\u53F7",placeholder:"6",prefix:"-"}]},$e={defaultComment:"\uC8FC\uC18C \uC5C5\uB370\uC774\uD2B8",postcodeField:{key:"addr:postcode",displayName:"Postcode",placeholder:""},mainFields:[{key:"addr:city",displayName:"City",placeholder:""}],detailFields:[{key:"addr:street",displayName:"Street",placeholder:""},{key:"addr:housenumber",displayName:"House number",placeholder:""}]},ae={JPN:Be,CHN:qe,DEU:De,KOR:$e},He=()=>{const[o,e]=s.exports.useState(!1);return{detectCountry:s.exports.useCallback(async(i,a)=>{e(!0);const f=await(await fetch("https://raw.githubusercontent.com/nvkelso/natural-earth-vector/master/geojson/ne_10m_admin_0_countries.geojson")).json();for(const y of f.features)if(fe([i,a],y.geometry))return console.log("country: ",y.properties),e(!1),y;e(!1)},[]),loadingCountry:o}},$=({feature:o,fieldOption:e,suggestList:r,onChange:i})=>{var y;const[a,c]=s.exports.useState((y=o.properties)==null?void 0:y[e.key]);s.exports.useEffect(()=>{var n;c((n=o.properties)==null?void 0:n[e.key])},[o]);const f=s.exports.useCallback(n=>{c(n.currentTarget.value),i&&i(n)},[]);return l("div",{className:"w-full md:w-1/6 py-1 px-2 mb-6 md:mb-0",children:[l("label",{className:"block tracking-wide text-gray-700 text-xs font-bold mb-2",htmlFor:e.key,children:[e.displayName," (",e.key,")"]}),t("input",{className:"appearance-none block w-full leading-tight rounded py-2 px-1 border border-gray-300 bg-gray-100 text-black placeholder-gray-500 placeholder-opacity-50 focus:outline-none focus:bg-white focus:border-gray-500",id:e.key,name:e.key,type:"text",autoComplete:"on",list:e.key+"-list",placeholder:e.placeholder,value:a,onChange:f}),t("datalist",{id:e.key+"-list",children:r&&r.map(n=>{if(parseInt(n.tags.admin_level)===e.adminLevel)return t("option",{value:n.tags.name},n.id);if(n.type==="node"&&e.adminLevel===9)return t("option",{value:n.tags.name},n.id)})})]})},Ge=({feature:o,fields:e})=>o.properties?l(C,{children:[e.postcodeField&&t("span",{children:o.properties[e.postcodeField.key]})," ",e.mainFields&&e.mainFields.map(r=>{var i;return l(C,{children:[t("span",{children:(i=o.properties)==null?void 0:i[r.key]})," "]})}),e.detailFields&&e.detailFields.map(r=>{var i;return l(C,{children:[t("span",{children:(i=o.properties)==null?void 0:i[r.key]})," "]})})]}):null,Je=({placeholder:o,defaultValue:e})=>{const[r,i]=s.exports.useState(e);s.exports.useEffect(()=>{i(e)},[e]);const a=s.exports.useCallback(c=>{i(c.currentTarget.value)},[]);return l("div",{className:"w-full md:w-1/3 py-1 px-2 mb-6 md:mb-0",children:[t("label",{className:"block tracking-wide text-gray-700 text-xs font-bold mb-2",htmlFor:"comment",children:"Comment for this changeset (* required)"}),t("input",{className:"appearance-none block w-full leading-tight rounded py-2 px-1 border border-gray-300 bg-gray-100 text-black placeholder-gray-500 placeholder-opacity-50 focus:outline-none focus:bg-white focus:border-gray-500",id:"comment",name:"comment",type:"text",placeholder:o,value:r,required:!0,onChange:a})]})},H={type:"FeatureCollection",features:[]},ie=()=>{const[o,e]=s.exports.useState(!1),r=s.exports.useCallback(async(f,y,n)=>{var I,A;if(o||(console.log(n),n<16))return H;e(!0);let b=300;n>17&&(b=200),n>18&&(b=100),n>19&&(b=50),console.log("overpass: loading...");let g="[out:json]";g+=`[timeout:25];
`,g+='nwr["building"]',g+=`(around:${b},${f},${y});
`,g+="out meta geom;",console.log(g);const k=await fetch(`https://lz4.overpass-api.de/api/interpreter?data=${encodeURIComponent(g)}`,{});if(k.status!==200)return e(!1),H;const u=await k.json();console.log("overpass json elements: ",u.elements);const w=ye(u);console.log("overpass osmtogeojson raw: ",w);for await(const m of w.features){if(!m.properties)continue;m.id=m.properties.id.split("/")[1];const O=(I=u.elements.filter(v=>m.id?typeof m.id=="number"?v.id===m.id:v.id===parseInt(m.id):!1))==null?void 0:I[0];if(O&&(m.properties.tags=O.tags,m.properties.nodes=O.nodes),m.geometry.type==="Polygon"){const v=be(m.geometry.coordinates);var F=xe(v);m.properties.center=F.geometry.coordinates}m.geometry.type==="Point"&&(m.properties.center=m.geometry.coordinates);const N=m.properties.uid;if(N){let v=localStorage.getItem(N+"-icon");if(v===null){const E=await S.exports.getUser(N);((A=E.img)==null?void 0:A.href)?(v=E.img.href,localStorage.setItem(N+"-icon",E.img.href)):localStorage.setItem(N+"-icon","")}m.properties.userIconHref=v||""}}return console.log("overpass osmtogeojson converted: ",w),console.log("overpass: loaded."),e(!1),w},[]),[i,a]=s.exports.useState(!1),c=s.exports.useCallback(async f=>{console.log("overpass: loading...",f),a(!0);const y=`
      [out:json]
      [timeout:25];
      node(id:${f.join(",")})->.nodes;
      .nodes is_in;
      area._[boundary=administrative];
      out;
    `;console.log(y);const n=await fetch(`https://lz4.overpass-api.de/api/interpreter?data=${encodeURIComponent(y)}`,{});if(n.status!==200){a(!1);return}const b=await n.json();console.log("overpass json parent elements: ",b.elements);const g=250,k=`
      [out:json]
      [timeout:25];
      node(id:${f.join(",")})->.nodes;
      rel
        [type=boundary]
        [boundary=administrative]
        (around.nodes:${g});
      out;
      `;console.log(k);const u=await fetch(`https://lz4.overpass-api.de/api/interpreter?data=${encodeURIComponent(k)}`,{});if(u.status!==200){a(!1);return}const w=await u.json();console.log("overpass json child elements: ",w.elements);const F=`
      [out:json]
      [timeout:25];
      node(id:${f.join(",")})->.nodes;
      node
        [place=neighbourhood]
        (around.nodes:${g});
      out;
      `;console.log(F);const I=await fetch(`https://lz4.overpass-api.de/api/interpreter?data=${encodeURIComponent(F)}`,{});if(I.status!==200){a(!1);return}const A=await I.json();return console.log("overpass json neighbour elements: ",A.elements),a(!1),[...b.elements,...w.elements,...A.elements]},[]);return{fetchOverpassBuildings:r,fetchOverpassAdmin:c,loadingOverpass:o,loadingOverpassAdmin:i}},Ve=()=>l("div",{className:"w-full md:w-1/6 py-1 px-2 mb-6 md:mb-0",children:[t("label",{className:"block tracking-wide text-gray-700 text-xs font-bold mb-2",htmlFor:"source",children:"Source of this changeset (* required)"}),t("input",{className:"appearance-none block w-full leading-tight rounded py-2 px-1 border border-gray-300 bg-gray-100 text-black placeholder-gray-500 placeholder-opacity-50 focus:outline-none focus:bg-white focus:border-gray-500",id:"source",name:"source",type:"text",autoComplete:"on",list:"source-list",placeholder:"OpenStreetMap",defaultValue:"",required:!0}),l("datalist",{id:"source-list",children:[t("option",{value:"survey"}),t("option",{value:"local knowledge"}),t("option",{value:"extrapolation"}),t("option",{value:"estimation from existing data"})]})]}),G={host:"https://yuiseki.github.io/osm-address-editor-vite/",created_by:"osm-address-editor-vite",locale:navigator.language,comment:"Update address",source:"OpenStreetMap"},Ke=({feature:o,onCancel:e,onSubmit:r})=>{var U,K,W,Y;const{detectCountry:i,loadingCountry:a}=He(),{fetchOverpassAdmin:c,loadingOverpassAdmin:f}=ie(),y=JSON.parse((U=o.properties)==null?void 0:U.center),[n,b]=s.exports.useState(void 0),[g,k]=s.exports.useState(),[u,w]=s.exports.useState(o),[F,I]=s.exports.useState(!1),[A,m]=s.exports.useState(!1),[O,N]=s.exports.useState(!1),[v,E]=s.exports.useState(),[T,d]=s.exports.useState();s.exports.useEffect(()=>{I(S.exports.isLoggedIn())},[]),s.exports.useEffect(()=>{(async()=>{var L,_;const h=await i(y[0],y[1]);if(b(h),((L=h==null?void 0:h.properties)==null?void 0:L.ISO_A3)&&ae[h.properties.ISO_A3]){const z=ae[h.properties.ISO_A3];k(z);const q=z.defaultComment+" "+((_=o.properties)==null?void 0:_.id);d(q)}})()},[o]),s.exports.useEffect(()=>{console.log(u.properties)},[u]);const p=s.exports.useCallback(async()=>{const h=await ve.openReverseGeocoder([y[0],y[1]]);w(L=>{const _={properties:R({"addr:province":h.prefecture,"addr:city":h.city},L.properties)};return R(R({},L),_)})},[]),x=s.exports.useCallback(async()=>{if(!u.properties)return;u.properties.nodes;const h=await c(JSON.parse(u.properties.nodes));console.log("onOverpassReverseGeocode",h),E(h)},[u]),M=s.exports.useCallback(async h=>{var Q,ee,te;N(!0),h.preventDefault();const L=new FormData(h.currentTarget),_=JSON.parse((Q=o.properties)==null?void 0:Q.tags);L.forEach((D,B)=>{typeof D=="string"&&D.length>0&&B!=="comment"&&B!=="source"&&(_[B]=D)});const z={type:"way",id:o.id,version:(ee=o.properties)==null?void 0:ee.version,tags:_,nodes:JSON.parse((te=o.properties)==null?void 0:te.nodes)};console.info(JSON.stringify(z,null,2));const q={create:[],modify:[z],delete:[]},X=L.get("comment");X&&(G.comment=X.toString());const Z=L.get("source");Z&&(G.source=Z.toString()),await S.exports.uploadChangeset(G,q),N(!1),window.alert(`Successfully updated OpenStreetMap!!!
 Wait a minutes to apply to the map...`),r()},[o]),j=s.exports.useCallback(()=>{m(!0)},[]);return u.properties?l("div",{children:[l("div",{children:["OSM:"," ",t("a",{className:"underline text-blue-600 hover:text-blue-800 visited:text-purple-600",href:"https://www.openstreetmap.org/"+u.properties.id,target:"_blank",children:u.properties.id})," | ",t(le,{feature:u}),g&&l("span",{children:[" | ","Address:"," ",t(Ge,{feature:u,fields:g})]})]}),a?t(P,{icon:J,spin:!0}):t(C,{children:g?l("form",{onSubmit:M,children:[t("div",{className:"flex flex-wrap",children:t($,{feature:u,fieldOption:g.postcodeField,onChange:j})}),t("div",{className:"flex flex-wrap",children:g.mainFields.map(h=>t($,{feature:u,fieldOption:h,onChange:j,suggestList:v},h.key))}),t("div",{className:"flex flex-wrap",children:g.detailFields.map(h=>t($,{feature:u,fieldOption:h,onChange:j},h.key))}),l("div",{className:"flex flex-wrap",children:[t(Ve,{}),t(Je,{defaultValue:T})]}),t("div",{className:"flex flex-wrap",children:l("div",{className:"w-full py-2 px-2 mb-6 md:mb-0",children:[t("button",{type:"button",onClick:e,className:"button rounded mr-4 py-2 px-3  bg-gray-200 text-red-600 hover:text-red-800",children:"Cancel"}),((K=n==null?void 0:n.properties)==null?void 0:K.ISO_A3)==="JPN"&&t("button",{type:"button",onClick:p,className:"button rounded mr-4 py-2 px-3 bg-green-300 text-gray-800 hover:text-white",children:"Load address from coordinates"}),l("button",{type:"button",disabled:f,onClick:x,className:"button rounded mr-4 py-2 px-3 bg-green-300 text-gray-800 hover:text-white",children:["Load suggestion from OSM",f&&t(P,{icon:J,spin:!0})]}),t("button",{disabled:!F||O||!A,className:"button rounded mr-2 py-2 px-3 bg-blue-300 text-gray-800 disabled:bg-blue-100 disabled:text-gray-400 hover:text-white",children:"Submit to OpenStreetMap!"}),!F&&l(C,{children:[t("span",{className:"mr-2 underline text-red-600",children:"Require logged in before you submit data to OpenStreetMap"}),t(ne,{})]})]})})]}):t("div",{className:"flex flex-wrap",children:l("div",{className:"w-full mb-6 md:mb-0",children:[l("div",{className:"py-2",children:[l("p",{children:["Sorry, Address editor in this country"," ",(W=n==null?void 0:n.properties)==null?void 0:W.NAME," (ISO code:",(Y=n==null?void 0:n.properties)==null?void 0:Y.ISO_A3,") does not support yet."]}),t("p",{children:t("a",{href:"https://github.com/yuiseki/osm-address-editor-vite",target:"_blank",className:"underline text-blue-600 hover:text-blue-800 visited:text-purple-600",children:"Pull requests are welcome!"})})]}),t("button",{type:"button",onClick:e,className:"button rounded mr-4 py-2 px-3  bg-gray-200 text-red-600 hover:text-red-800",children:"Cancel"})]})})})]}):null};function We(o,e){const[r,i]=s.exports.useState(o);return s.exports.useEffect(()=>{const a=setTimeout(()=>{i(o)},e);return()=>{clearTimeout(a)}},[o,e]),r}const Ye={version:8,sources:{"osm-raster-tiles":{type:"raster",tiles:["https://a.tile.openstreetmap.org/{z}/{x}/{y}.png","https://b.tile.openstreetmap.org/{z}/{x}/{y}.png","https://c.tile.openstreetmap.org/{z}/{x}/{y}.png"],tileSize:256,attribution:"\xA9 OpenStreetMap contributors"}},layers:[{id:"osm-tiles",type:"raster",source:"osm-raster-tiles",minzoom:0,maxzoom:20}]},Xe={id:"buildings-layer-fill",type:"fill",source:"buildings-source",paint:{"fill-color":["case",["boolean",["feature-state","select"],!1],"green",["all",["boolean",["has","addr:postcode"],!1],["boolean",["has","addr:province"],!1],["boolean",["has","addr:city"],!1],["boolean",["has","addr:quarter"],!1],["boolean",["has","addr:block_number"],!1],["boolean",["has","addr:housenumber"],!1]],"blue",["all",["boolean",["has","addr:postcode"],!1],["boolean",["has","addr:province"],!1],["boolean",["has","addr:district"],!1],["boolean",["has","addr:street"],!1],["boolean",["has","addr:housenumber"],!1]],"blue",["all",["boolean",["has","addr:postcode"],!1],["boolean",["has","addr:province"],!1],["boolean",["has","addr:district"],!1],["boolean",["has","addr:street"],!1],["boolean",["has","addr:housenumber"],!1]],"blue",["all",["boolean",["has","addr:postcode"],!1],["boolean",["has","addr:city"],!1],["boolean",["has","addr:street"],!1],["boolean",["has","addr:housenumber"],!1]],"blue",["any",["boolean",["has","addr:postcode"],!1],["boolean",["has","addr:province"],!1],["boolean",["has","addr:city"],!1],["boolean",["has","addr:district"],!1],["boolean",["has","addr:suburb"],!1],["boolean",["has","addr:quarter"],!1],["boolean",["has","addr:street"],!1],["boolean",["has","addr:neighbourhood"],!1],["boolean",["has","addr:block_number"],!1],["boolean",["has","addr:housenumber"],!1]],"yellow","red"],"fill-opacity":["case",["boolean",["feature-state","select"],!1],.8,["boolean",["feature-state","hover"],!1],.8,.4]},filter:["==","$type","Polygon"]};function Ze(){const o=s.exports.useRef(null),[e,r]=s.exports.useState(),i=We(e,2500),a=s.exports.useRef(null),[c,f]=s.exports.useState({type:"FeatureCollection",features:[]}),[y,n]=s.exports.useState("auto"),[b,g]=s.exports.useState(),[k,u]=s.exports.useState([]),{fetchOverpassBuildings:w,loadingOverpass:F}=ie();s.exports.useEffect(()=>{setTimeout(()=>{var d;console.log(window.location.hash),!!window.location.hash.endsWith("/0/0")&&(console.log("geolocateControlRef trigger"),(d=a.current)==null||d.trigger())},500)},[]);const I=s.exports.useCallback(d=>{const p=d.target.getCenter(),x=d.target.getZoom();r({zoom:x,latitude:p.lat,longitude:p.lng,bearing:0,pitch:0,padding:{top:0,bottom:0,left:0,right:0}})},[]),A=s.exports.useCallback(d=>{r(d.viewState)},[]),m=s.exports.useCallback(d=>{r(d.viewState)},[]);s.exports.useEffect(()=>{(async()=>{if(!i)return;const d=i,p=await w(d.latitude,d.longitude,d.zoom);f(p)})()},[i]);const O=s.exports.useCallback(d=>{var U;n("pointer");const{features:p,point:{x,y:M}}=d,j=p&&p[0];j?((U=o.current)==null||U.setFeatureState({source:"buildings-source",id:j.id},{hover:!0}),g({feature:j,x,y:M})):g(void 0)},[]),N=s.exports.useCallback(d=>{var p;n("auto"),(p=o.current)==null||p.querySourceFeatures("buildings-source").map(x=>{var M;(M=o.current)==null||M.setFeatureState({source:"buildings-source",id:x.id},{hover:!1})}),g(void 0)},[]),v=s.exports.useCallback(d=>{var x;E();const p=d.features&&d.features[0];!p||((x=o.current)==null||x.setFeatureState({source:"buildings-source",id:p.id},{select:!0}),u([p]))},[]),E=s.exports.useCallback(()=>{var d;(d=o.current)==null||d.querySourceFeatures("buildings-source").map(p=>{var x;(x=o.current)==null||x.setFeatureState({source:"buildings-source",id:p.id},{select:!1})}),u([])},[]),T=s.exports.useMemo(()=>{let d=25;return e&&(d=e.zoom<18?20:e.zoom<19?25:35),c.features.map((p,x)=>!p.properties||!p.properties.center?null:t(we,{style:{cursor:"pointer"},longitude:p.properties.center[0],latitude:p.properties.center[1],anchor:"center",children:t(Ue,{feature:p,size:d})},`marker-${x}`))},[c,e]);return l("div",{children:[t(Re,{}),t("div",{style:{zIndex:300,position:"absolute",bottom:10,left:10},children:t(Te,{viewState:e})}),l("div",{style:{zIndex:1,position:"absolute",top:0,left:0,height:"100vh",width:"100vw",display:"flex",flexDirection:"column"},children:[k.length>0&&t("div",{style:{zIndex:200,position:"absolute",top:"44px",left:0,width:"100vw",backgroundColor:"rgba(255, 255, 255, 0.9)"},children:t("div",{style:{padding:"10px"},children:k.map(d=>t(Ke,{feature:d,onCancel:E,onSubmit:E},d.id))})}),l(Se,re(R({ref:o},e),{onMove:A,onMoveEnd:m,onLoad:I,interactiveLayerIds:["buildings-layer-fill"],onClick:v,onMouseEnter:O,onMouseLeave:N,dragRotate:!1,boxZoom:!1,hash:!0,cursor:y,mapLib:Ce,style:{width:"100%",height:"100%"},mapStyle:Ye,children:[t(ke,{id:"buildings-source",type:"geojson",data:c,children:t(Ne,R({},Xe))}),t(Fe,{position:"top-left",style:{marginTop:"55px"},showCompass:!1}),t(Ie,{ref:a,position:"top-left",showUserLocation:!0,showAccuracyCircle:!1,trackUserLocation:!1,positionOptions:{enableHighAccuracy:!0},fitBoundsOptions:{zoom:17}}),t("div",{className:"fa-2xl",style:{zIndex:100,display:"flex",position:"absolute",top:"50%",left:"50%",textAlign:"center",verticalAlign:"middle"},children:!e||(e==null?void 0:e.zoom)&&e.zoom<16?t(P,{size:"2x",icon:Ae}):F?t(P,{size:"2x",icon:J,spin:!0}):t(P,{size:"2x",icon:Ee})}),T,b&&l("div",{className:"tooltip",style:{zIndex:10,background:"rgba(255, 255, 255, 0.7)",padding:"5px",width:"250px",position:"absolute",left:b.x+5,top:b.y+5},children:[t(le,{feature:b.feature}),t("br",{}),t(ze,{feature:b.feature}),t(Pe,{feature:b.feature})]})]}))]})]})}window.Buffer=Le.Buffer;Oe.render(t(je.StrictMode,{children:t(Ze,{})}),document.getElementById("root"));
